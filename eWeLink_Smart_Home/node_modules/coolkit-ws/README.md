# 使用

## 初始化

使用该插件**必须先初始化**，否则报错。

### 参数

**config 对象**

| 名称 | 类型 | 允许空 | 说明|
| --- | --- | --- | --- |
|appid| string| N|appid|
|secret| string| N|secret|
|at| string|N|用户 at|
|apikey| string|N|用户 apiKey|

### 返回值

| 名称  | 类型   | 说明                         |
| ----- | ------ | ---------------------------- |
| error | string | 错误码 0:无错误 601:连接错误 |
| msg   | string | 错误或成功信息               |

### 示例

```js
import coolKitWs from 'coolkit-ws';
const config = {
    appid: 'your-app-id',
    secret: 'your-secret',
    at: 'your-at',
    apikey: 'your-apiKey',
};

const result = await coolKitWs.init(config);
console.log('连接的结果: ', result);
```

## 更新设备状态

### 参数

**config 对象**

| 名称 | 类型 | 允许空 | 说明|
| --- | --- | --- | --- |
|deviceid| string| N|设备 id|
|deviceApikey| string| N|设备 apiKey|
|params| object|N|更新参数|

### 返回值

| 名称     | 类型   | 说明               |
| -------- | ------ | ------------------ |
| error    | string | 错误码             |
| deviceid | string | 设备 id            |
| apikey   | string | 设备 apiKey        |
| sequence | string | 用于标识消息的序列 |

### 示例

```js
import coolKitWs from 'coolkit-ws';
const updateResult = await coolKitWs.updateThing({
    deviceid: 'your-device-id',
    deviceApikey: 'your-device-apiKey',
    params: {
        // your params
    },
});

console.log('更新结果: ', updateResult);
```

## 查询设备状态

### 参数

**config 对象**

| 名称 | 类型 | 允许空 | 说明|
| --- | --- | --- | --- |
|deviceid| string| N|设备 id|
|deviceApikey| string| N|设备 apiKey|
|params| array[string] or string |N|查询选项|

### 返回值

| 名称     | 类型   | 说明               |
| -------- | ------ | ------------------ |
| error    | string | 错误码             |
| deviceid | string | 设备 id            |
| apikey   | string | 设备 apiKey        |
| sequence | string | 用于标识消息的序列 |
| params   | string | 查询结果           |

### 示例

```js
import coolKitWs from 'coolkit-ws';
const queryResult = await coolKitWs.queryThing({
    deviceid: 'your-device-id',
    deviceApikey: 'your-device-apiKey',
    params: ['your-query-item1', 'your-query-item2'] | 'your-query-item',
});

console.log('查询结果', queryResult);
```

## 设置回调函数监听长连接

### 参数

**config 对象**

| 名称 | 类型 | 允许空 | 说明|
| --- | --- | --- | --- |
|method| string| N|监听事件名称 "message" "open" "close" "error"|
|callback| function| N|回调函数|

### 示例

```js
import coolKitWs from 'coolkit-ws';
coolKitWs.on('message', (ev) => {
    console.log('我接收到消息了', ev.data);
});
```

## 关闭长连接

### 参数

无

### 返回值

无

### 示例

```js
import coolKitWs from 'coolkit-ws';
coolKitWs.close();
```
